<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.i4.i4blog.db.admin.interfaces.ReportRepository">
    <select id="reports" resultType="com.i4.i4blog.db.admin.model.Report">
        select r.id as id,
        r.user_id as user_id,
        r.board_id as board_id,
        r.report_content as report_content,
        r.report_type as report_type,
        b.board_title as board_title,
        count(*) over(partition by r.board_id)
        from report r
        join board b on r.board_id = b.id
        where
        <choose>
            <when test="type == ''">
                1=1
            </when>
            <otherwise>
                report_tye = #{type}
            </otherwise>
        </choose>
    </select>
</mapper>